SELECT  distinct TOP 10 tran_nr, system_trace_audit_nr, retrieval_reference_nr, DATEDIFF(MILLISECOND, (SELECT datetime_req FROM post_tran (NOLOCK, INDEX(ix_post_tran_2)) WHERE tran_nr =trans.tran_nr AND tran_postilion_originated =0 and post_tran_cust_id=trans.post_tran_cust_id), (SELECT datetime_req FROM post_tran (NOLOCK, INDEX(ix_post_tran_2)) WHERE tran_nr =trans.tran_nr AND tran_postilion_originated =1 and post_tran_cust_id=trans.post_tran_cust_id)) processing_time  FROM post_tran trans(NOLOCK, INDEX(ix_post_tran_2)) 
